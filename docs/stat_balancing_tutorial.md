# 角色数值平衡教程

本文档旨在为游戏设计者提供一套关于角色核心数值（HP, ATK, DEF）的平衡方法与实践指南。平衡的目标是确保所有角色在不同等级和游戏阶段都能发挥其预设的战斗作用，同时避免出现过强（OP）或过弱（UP）的角色。

## 一、核心战斗公式

战斗伤害的计算是数值平衡的基石。理解伤害如何产生，是调整角色攻防属性的前提。

### 1. 基础伤害公式

游戏中，所有技能伤害都遵循一个核心减法公式：

```
最终伤害 = 技能理论伤害值 - 目标防御值（DEF）
```

为避免负数伤害（即攻击为目标回血）的情况，我们设定最终伤害的最小值为 `0`。

```typescript
// From: src/js/battle/participants.ts
const finalDamage = Math.max(0, skillDamage - target.def);
```

### 2. 属性克制加成

在基础伤害之上，我们引入了属性克制系统。攻击方对被攻击方存在属性克制时，会获得一定比例的伤害加成。

```typescript
// From: src/js/battle/engine.ts
const attributeBonus = 1 + attacker.attributeBonus[target.type];
const finalSkillDamage = skillDamage * attributeBonus;
```

因此，完整的伤害公式为：

```
最终伤害 = Max(0, (技能理论伤害值 * 属性克制系数) - 目标防御值)
```

## 二、角色等级成长曲线

角色的核心三维属性（HP, ATK, DEF）会随着等级提升而成长。我们采用非线性的成长曲线，确保角色在游戏后期依然有足够的成长感。

所有公式均源自 `src/js/characters/base.ts` 中的 `init_stat` 方法。

### 1. HP（生命值）

```
HP = 500 + 120 * 等级 + 15 * 等级^1.25
```

- **基础值 (500)**: 保证角色在1级时具备基础的生存能力。
- **线性增长 (120 * 等级)**: 提供稳定、可预期的成长。
- **指数增长 (15 * 等级^1.25)**: 使角色在后期获得更快的生命值提升，以应对后期更强的敌人。

### 2. ATK（攻击力）

```
ATK = 100 + 25 * 等级 + 4 * 等级^1.15
```

- **基础值 (100)**: 定义了初期的基本输出能力。
- **线性增长 (25 * 等级)**: 稳定提升输出。
- **指数增长 (4 * 等级^1.15)**: 确保后期输出不会乏力。

### 3. DEF（防御力）

```
DEF = 50 + 15 * 等级 + 2 * 等级^1.1
```

- **基础值 (50)**: 定义了初期的基本减伤能力。
- **线性增长 (15 * 等级)**: 稳定提升生存。
- **指数增长 (2 * 等级^1.1)**: 减缓了后期伤害溢出的问题。

## 三、黄金比例与平衡基准

为了方便设计者快速评估一个角色的数值是否“合理”，我们根据成长公式，定义了几个关键等级的“黄金比例”。一个标准模板的输出型角色，其 HP:ATK:DEF 的比例应接近以下数值。

| 等级 | HP | ATK | DEF | 黄金比例 (HP:ATK:DEF) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 635 | 129 | 67 | ≈ 9.5 : 1.9 : 1 |
| 25 | 5060 | 953 | 487 | ≈ 10.4 : 2.0 : 1 |
| 50 | 11571 | 2056 | 1004 | ≈ 11.5 : 2.0 : 1 |

**设计原则**:
- **坦克型角色**: 应显著高于此比例中的 HP 和 DEF 值。
- **输出型角色（DPS）**: ATK 值应显著高于此比例，但 HP 和 DEF 可能会稍低。
- **辅助型角色**: 数值可能不遵循此比例，其价值更多体现在技能效果上。

## 四、混合属性缩放设计

为了创造更独特的角色机制，部分角色的技能伤害会同时受到多个属性的影响，这被称为“混合属性缩放”。

### 设计案例：水厉方 (ShuiLiFang)

水厉方是一个典型的案例，她的技能伤害同时基于自身的 **ATK** 和 **HP**。

- **普通攻击**: `0.5 * ATK + 0.1 * HP`
- **技能攻击**: `1.2 * ATK + 0.15 * HP`

这种设计的优势在于：
1.  **打破单一属性堆叠**: 玩家不能只专注于提升攻击力，也需要考虑生命值，增加了配装的策略深度。
2.  **角色特性塑造**: 高生命值不仅意味着生存能力强，也直接转化为输出能力，完美契合了“愈战愈勇”的坦克型输出角色定位。
3.  **平衡性调节**: 通过调整 ATK 和 HP 的系数，可以精确地控制角色的输出上限和下限，使其在不同战斗场景下表现各异。

在设计此类角色时，务必确保其总输出期望值与其他纯 ATK 型角色保持在同一水平线上，避免其因多重属性加成而变得过强。
